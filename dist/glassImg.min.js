(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
    typeof define === 'function' && define.amd ? define(factory) :
    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.GlassImg = factory());
}(this, (function () { 'use strict';

    var GlassImg = /** @class */ (function () {
        function GlassImg(opts) {
            this.init(opts);
        }
        // 初始化方法
        GlassImg.prototype.init = function (opts) {
            var that = this;
            var boxEle = document.getElementById(opts.id);
            var handEle = document.createElement('div');
            var bigImgEle = document.createElement('div');
            var imgEle = document.createElement('img');
            this.$boxWidth = opts.width;
            this.$boxHeight = opts.height;
            imgEle.src = opts.img;
            imgEle.style.position = 'absolute';
            imgEle.style.top = 0 + 'px';
            imgEle.style.left = 0 + 'px';
            imgEle.onload = function () {
                that.imgLoad(imgEle, handEle);
                // that.$imgWidth = imgEle.width;
                // that.$imgHeight = imgEle.height;
                // that.$scaleX = opts.width/imgEle.width;
                // that.$scaleY = opts.height/imgEle.height;
                // handEle.style.width = opts.width * that.$scaleX + 'px';
                // handEle.style.height = opts.height * that.$scaleY  + 'px';
                // handEle.style.position = 'absolute';
                // handEle.style.background = 'blue';
                // handEle.style.opacity = '0.4';
                // handEle.style.display = 'none';
            };
            boxEle.style.width = opts.width + 'px';
            boxEle.style.height = opts.height + 'px';
            boxEle.style.position = 'relative';
            boxEle.style.backgroundImage = "url(" + opts.img + ")";
            boxEle.style.backgroundSize = "cover";
            bigImgEle.style.width = opts.width + 'px';
            bigImgEle.style.height = opts.height + 'px';
            bigImgEle.style.position = 'absolute';
            bigImgEle.style.overflow = 'hidden';
            bigImgEle.style.left = boxEle.offsetLeft + opts.width + 'px';
            bigImgEle.style.top = 0 + 'px';
            bigImgEle.style.display = 'none';
            boxEle.appendChild(handEle);
            boxEle.appendChild(bigImgEle);
            bigImgEle.appendChild(imgEle);
            this.boxEle = boxEle;
            this.handEle = handEle;
            this.bigImgEle = bigImgEle;
            this.imgEle = imgEle;
            this.addEvent();
        };
        GlassImg.prototype.addEvent = function () {
            var _this = this;
            this.boxEle.onmouseover = function () {
                _this.over();
            };
            this.boxEle.onmouseleave = function () {
                _this.leave();
            };
            this.boxEle.onmousemove = function (event) {
                var e = event || window.event;
                _this.move(e);
            };
        };
        GlassImg.prototype.over = function () {
            this.handEle.style.display = 'block';
            this.bigImgEle.style.display = 'block';
        };
        GlassImg.prototype.leave = function () {
            this.handEle.style.display = 'none';
            this.bigImgEle.style.display = 'none';
        };
        GlassImg.prototype.move = function (e) {
            var l = e.clientX - this.boxEle.offsetLeft - this.handEle.offsetWidth / 2;
            var t = e.clientY - this.boxEle.offsetTop - this.handEle.offsetHeight / 2;
            if (l < 0)
                l = 0;
            if (t < 0)
                t = 0;
            if (l > this.boxEle.offsetWidth - this.handEle.offsetWidth) {
                l = this.boxEle.offsetWidth - this.handEle.offsetWidth;
            }
            if (t > this.boxEle.offsetHeight - this.handEle.offsetHeight) {
                t = this.boxEle.offsetHeight - this.handEle.offsetHeight;
            }
            this.handEle.style.left = l + 'px';
            this.handEle.style.top = t + 'px';
            this.imgEle.style.left = -l / this.$scaleX + 'px';
            this.imgEle.style.top = -t / this.$scaleY + 'px';
        };
        GlassImg.prototype.changeImg = function (path) {
            var that = this;
            this.imgEle.src = path;
            this.boxEle.style.backgroundImage = "url(" + path + ")";
            this.imgEle.onload = function () {
                that.imgLoad(that.imgEle, that.handEle);
            };
        };
        GlassImg.prototype.imgLoad = function (imgEle, handEle) {
            this.$imgWidth = imgEle.width;
            this.$imgHeight = imgEle.height;
            this.$scaleX = this.$boxWidth / imgEle.width;
            this.$scaleY = this.$boxHeight / imgEle.height;
            handEle.style.width = this.$boxWidth * this.$scaleX + 'px';
            handEle.style.height = this.$boxHeight * this.$scaleY + 'px';
            handEle.style.position = 'absolute';
            handEle.style.background = 'blue';
            handEle.style.opacity = '0.4';
            handEle.style.display = 'none';
        };
        return GlassImg;
    }());

    return GlassImg;

})));
//# sourceMappingURL=glassImg.min.js.map
